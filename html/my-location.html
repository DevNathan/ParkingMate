<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ParkingMate</title>

  <!-- 전체 스타일 -->
  <link rel="stylesheet" href="../css/style.css">

  <!-- 헤더 스타일CSS -->
  <link rel="stylesheet" href="../css/header.css">

  <!-- 로고 -->
  <link href="../images/favicon.ico" rel="shortcut icon" type="image/x-icon" />

  <!-- 메인CSS -->
  <link rel="stylesheet" href="../css/main.css">

  <!-- 내 위치JS -->
  <script src="../js/map.js"></script>

  <!-- 하단 배너 선택 JS -->
  <script src="../js/my-location-footer.js"></script>

</head>
<body>
  <!-- 바디 전체박스 -->
  <div class="wrap">

    <!-- 헤더박스 -->
    <div class="header">

      <!-- 헤더 안 컨테이너 전체박스 -->
      <div class="header-wrap">

        <!-- 헤더 컨테이너 -->
        <div class="header-container">

          <!-- 하단 배너 -->
          <ul class="gnb-container">

            <!-- 홈 -->
            <li class="gnb-item" id="home-li">
              <a class="gnb-link" href="">

                <!-- pm 로고 -->
                <img src="../images/logo.svg" style="width:28px;height:28px;" class="gnb-svg"/>
                <span class="gnb-text on">홈</span>

              </a>
            </li>

            <!-- 예약 -->
            <li class="gnb-item" id="reservation-li">
              <a class="gnb-link" href="">

                <!-- 예약하기 로고 (할당x)-->
                <svg id="reservation-logo" viewBox="0 0 24 24" fill="none" focusable="false" role="presentation" 
                  class="withIcon_icon__3VTbq GNBMobile_icon__3OOAF GNBIcon_feed__1AjUB" 
                  aria-hidden="true" style="width: 21px; height: 21px;">
                  <path id="reservation-path" fill-rule="evenodd" clip-rule="evenodd" d="M21 5.5a4.502 4.502 0 0 1-2.979 4.236l1.343 6.267a3.5 3.5 0 1 1-3.345 3.127l-4.537-1.297a5.5 5.5 0 1 1-1.878-6.874l3.192-2.903A4.5 4.5 0 1 1 21 5.5zm-3.233 3.048a3.301 3.301 0 1 0-2.536-6.096 3.301 3.301 0 0 0 2.536 6.096zM16.5 10a4.482 4.482 0 0 1-2.896-1.056l-3.084 2.803a5.517 5.517 0 0 1 1.35 4.95l4.479 1.279a3.513 3.513 0 0 1 1.842-1.723l-1.343-6.266c-.115.009-.231.013-.348.013zm-10 1.2a4.28 4.28 0 0 1 3.132 1.354 4.285 4.285 0 0 1 1.08 3.811c-.081.401-.219.781-.403 1.133a4.317 4.317 0 0 1-2.067 1.934A4.3 4.3 0 1 1 6.5 11.2zm13.895 10.42a2.3 2.3 0 1 0-.895.18c.317 0 .62-.064.895-.18z">
                  </path>
                </svg>

                <!-- 예약 로고 (할당o) -->
                <span class="gnb-text">예약하기</span>

              </a>
            </li>

            <!-- 플러스 -->
            <li class="gnb-item">
              <div class="gnb-link">

                <!-- 플러스 로고 -->
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0icjRzeW8za3R4YSIgZD0iTTAgMGg0MHY0MEgweiIvPgogICAgPC9kZWZzPgogICAgPGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8Zz4KICAgICAgICAgICAgPG1hc2sgaWQ9Im1kajRrdnh3amIiIGZpbGw9IiNmZmYiPgogICAgICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPSIjcjRzeW8za3R4YSIvPgogICAgICAgICAgICA8L21hc2s+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0yMCAwQzguOTU0IDAgMCA4Ljk1NSAwIDIwYzAgMTEuMDQ2IDguOTU0IDIwIDIwIDIwczIwLTguOTU0IDIwLTIwQzQwIDguOTU1IDMxLjA0NiAwIDIwIDBtMCAxYzEwLjQ3NyAwIDE5IDguNTIzIDE5IDE5cy04LjUyMyAxOS0xOSAxOVMxIDMwLjQ3NyAxIDIwIDkuNTIzIDEgMjAgMSIgZmlsbD0iIzg2OEU5NiIgbWFzaz0idXJsKCNtZGo0a3Z4d2piKSIvPgogICAgICAgIDwvZz4KICAgICAgICA8cGF0aCBzdHJva2U9IiM4NjhFOTYiIGQ9Ik0yMCAxMXYxOE0yOSAyMEgxMSIvPgogICAgPC9nPgo8L3N2Zz4K" alt="">

              </div>

            </li>

            <!-- 찜하기 -->
            <li class="gnb-item" id="select-li">
              <a class="gnb-link" href="">

                <!-- 하트 로고 -->
                <svg id="select-logo" viewBox="0 0 32 32" focusable="false" role="presentation" 
                  class="withIcon_icon__3VTbq GNBMobile_icon__3OOAF" aria-hidden="true" 
                  style="width: 24px; height: 24px;">
                  <path id="select-path" d="M22.16 4h-.007a8.142 8.142 0 0 0-6.145 2.79A8.198 8.198 0 0 0 9.76 3.998a7.36 7.36 0 0 0-7.359 7.446c0 5.116 4.64 9.276 11.6 15.596l2 1.76 2-1.76c6.96-6.32 11.6-10.48 11.6-15.6v-.08A7.36 7.36 0 0 0 22.241 4h-.085zm-5.28 21.84l-.88.8-.88-.8h-.08C8.4 19.76 4 15.84 4 11.44l-.001-.082A5.76 5.76 0 0 1 9.928 5.6a6.542 6.542 0 0 1 4.865 2.232l.486.567h1.52l.48-.56a6.548 6.548 0 0 1 4.877-2.24l.084-.001a5.76 5.76 0 0 1 5.76 5.76l-.001.085c0 4.396-4.4 8.316-11.12 14.396z">
                  </path>
                </svg>
                <span class="gnb-text">찜하기</span>
                
              </a>
            </li>

            <!-- 마이파킹메이트 -->
            <li class="gnb-item" id="parkingMate-li">
              <a class="gnb-link" href="">

                <!-- 마이파킹메이트 로고 -->
                <svg id="parkingMate-logo" viewBox="0 0 40 40" focusable="false" role="presentation" 
                  class="withIcon_icon__3VTbq GNBMobile_icon__3OOAF" aria-hidden="true" 
                  style="width: 24px; height: 24px;">
                  <path id="parkingMate-path" d="M20.27 22.3a9.43 9.43 0 1 0-9.42-9.42 9.43 9.43 0 0 0 9.42 9.42zm0-16.76a7.34 7.34 0 1 1-7.34 7.34 7.34 7.34 0 0 1 7.34-7.34zm0 20.05c-6.52 0-15.19 1.09-15.19 10.57h2.08c0-5.95 3.92-8.49 13.11-8.49s13.11 2.54 13.11 8.49h2.08c0-9.48-8.67-10.57-15.19-10.57z">
                  </path><path fill="none" d="M0 0h40v40H0z"></path>
                </svg>
                <span class="gnb-text">마이파킹메이트</span>

              </a>
            </li>

          </ul>

          <!-- 뒤로가기 버튼 -->
          <button class="back-button button-all">

            <!-- 뒤로가기 이미지 -->
            <svg viewBox="0 0 24 24" fill="none" focusable="false" 
              role="presentation" class="withIcon_icon__3VTbq Button_icon__2Lds2" 
              aria-hidden="true" style="width: 24px;height: 24px;">
              <path fill-rule="evenodd" clip-rule="evenodd" 
              d="M16.076 2.576l.848.848L8.35 12l8.575 8.576-.848.848L6.65 12l9.425-9.424z">
              </path>
            </svg>

          </button>

          <!-- 홈 버튼 -->
          <button class="home-button button-all">
            <a class="" href="">

              <!-- 홈 이미지 -->
              <svg viewBox="0 0 40 40" focusable="false" role="presentation" 
                class="withIcon_icon__3VTbq Button_icon__2Lds2" aria-hidden="true" 
                style="width: 24px; height: 24px;">
                <path d="M13.38 36.13h2.4v-13.9h8.44v13.9h2.4V19.84H13.38v16.29z"></path>
                <path d="M20 3.41L3.8 14.49v21.64h2.4V15.75L20 6.32l13.8 9.43v20.38h2.4V14.49L20 3.41z"></path>
                <path fill="none" d="M0 0h40v40H0z"></path>
              </svg>

            </a>
          </button>

          <!-- 검색 버튼 -->
          <button class="search-button button-all">

            <!-- 검색 이미지 -->
            <svg viewBox="0 0 40 40" focusable="false" role="presentation" 
              class="withIcon_icon__3VTbq Button_icon__2Lds2" aria-hidden="true" 
              style="width: 24px; height: 24px;"><path fill="none" d="M0 0h40v40H0z"></path>
              <path d="M29.2 27.91a14.38 14.38 0 1 0-1.42 1.4l7.16 7.15.07.08 1.41-1.41zM18.45 6a12.36 12.36 0 0 1 8.35 3.23 12.24 12.24 0 0 1 4 8.59A12.39 12.39 0 1 1 17.88 6z"></path>
            </svg>

          </button>

          <!-- 로고 -->
          <div class="title-logo">
            <p class="title">ParkingMate</p>
          </div>

        </div>

      </div>

    </div>

    <!-- 메인박스 -->
    <div class="main">

      <!-- 카카오 지도 API -->
      <div id="map" style="width:100%;height:100vh;"></div>

      <!-- 내 위치 버튼 -->
      <button type="button" class="my-location-button" id="getMyPositionBtn" onclick="getCurrentPosBtn()" >

        <!-- 내 위치 이미지 -->
        <img src="../images/location-black.png" class="my-location-image">

      </button>

      <!-- 밑에서 올라오는 페이지 -->
      <div class="footer-page">

        <!-- 페이지 닫는 x 버튼 div -->
        <div class="close-page-bx">

          <!-- 페이지 닫은 버튼 -->
          <button class="close-page-btn" type="button">

            <svg viewBox="0 0 40 40" focusable="false" role="presentation" class="withIcon_icon__3VTbq MobileHeadupBanner_closeIcon__3PUoF" aria-hidden="true"><path d="M33.4 8L32 6.6l-12 12-12-12L6.6 8l12 12-12 12L8 33.4l12-12 12 12 1.4-1.4-12-12 12-12z"></path></svg>

          </button>

        </div>
        
        <!-- 이미지 div -->
        <div class="imagebx">
          
          <!-- 이미지 span -->
          <div class="pk-img"></div>

        </div>

        <!-- 밑에서 올라오는 페이지 사진 아래 전체박스 -->
        <div class="footer-page-ibx">
          
          <!-- 주차장 제목, 공유 -->
          <div class="parking-name-share">

            <!-- 주차장 이름 -->
            <div class="parking-name">

              <!-- 주차장 이름 텍스트 -->
              <p class="parking-name-p">
                어디어디어디 주차장
              </p>
            </div>

            <!-- 주차장 공유 버튼 -->
            <div class="parking-share">

              <!-- 주차장 공유 -->
              <p class="parking-share-p">
                
                <a href="">
                  주차장 공유
                </a>
              </p>

            </div>

          </div>

          <!-- 별, 점수, 리뷰갯수, 로드뷰 -->
          <ul class="star-point-roadview">

            <!-- 별모양 박스 -->
            <li class="star-box">

              <!-- 별 이미지 -->
              <img src="../images/star.png" class="star-img">

            </li>

            <!-- 리뷰 점수 -->
            <li class="point-box">

              <!-- 리뷰 텍스트 -->
              <p class="point-p">4.7</p>

            </li>

            <!-- 리뷰 갯수 -->
            <li class="review-number">

              <!-- 리뷰 갯수 텍스트 -->
              <p class="review-p">(200)</p>

            </li>

            <!-- 로드뷰 박스 -->
            <li class="loadview-box">

              <!-- 로드뷰 텍스트 -->
              <p class="loadview-p">
                
                <a href="">
                  로드뷰
                </a>

              </p>

            </li>

          </ul>

          <!-- 가격박스 -->
          <div class="price-box">

            <!-- 가격 숫자 -->
            <p class="price-number">29,000</p>

            <!-- 가격 뒤 원 -->
            <p class="price-number2">원</p>

          </div>

          <!-- 주차장 설명박스 -->
          <div class="parking-content-box">

            <!-- 주차장 설명 -->
            <p class="parking-content">
              경기도 성남시 탁구 우동 주차장-주소
            </p>

          </div>

          <!-- 예약하기 버튼 박스 -->
          <div class="reservation-button">

            <!-- 예약하기 텍스트 -->
            <p>예약하기</p>

          </div>

        </div>

      </div>
      
    </div>

    <!-- 하단박스 -->
    <div class="footer">

    </div>
  </div>
</body>

<!-- 카카오 지도 API -->
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=2ae38faa102a6f6c2867b0e8cbd5df73&libraries=services"></script>
<script>

  // 카카오 지도 API
  // 마커를 클릭하면 장소명을 표출할 인포윈도우 입니다
var infowindow = new kakao.maps.InfoWindow({zIndex:1});

// x 버튼 선택
const xBtn = document.querySelector(".close-page-btn");

// 밑에서 올라오는 페이지 선택
const footerPage = document.querySelector(".footer-page");

// 밑에서 올라오는 페이지 위치
const footerPageOpen = document.querySelector(".open")

// 밑에서 올라오는 페이지 안 제목
const footerPageTitle = document.querySelector(".parking-name-p")

var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
    mapOption = {
        center: new kakao.maps.LatLng(37.566826, 126.9786567), // 지도의 중심좌표
        level: 3 // 지도의 확대 레벨
    };  

// 지도를 생성합니다    
var map = new kakao.maps.Map(mapContainer, mapOption); 

// 장소 검색 객체를 생성합니다
var ps = new kakao.maps.services.Places(map); 

// 카테고리로 주차장을 검색합니다
ps.categorySearch('PK6', placesSearchCB, {useMapBounds:true}); 

// 키워드 검색 완료 시 호출되는 콜백함수 입니다
function placesSearchCB (data, status, pagination) {
    if (status === kakao.maps.services.Status.OK) {
        for (var i=0; i<data.length; i++) {
            displayMarker(data[i]);    
        }       
    }
}

// 지도에 마커를 표시하는 함수입니다
function displayMarker(place) {
    // 마커를 생성하고 지도에 표시합니다
    var marker = new kakao.maps.Marker({
        map: map,
        position: new kakao.maps.LatLng(place.y, place.x) 
    });

    // 마커에 클릭이벤트를 등록합니다
    kakao.maps.event.addListener(marker, 'click', function() {
        // 마커를 클릭하면 장소명이 인포윈도우에 표출됩니다
        infowindow.setContent('<div style="padding:5px;font-size:12px;">' + place.place_name + '</div>');
        // footerPage.classList.add("open");
        infowindow.open(map, marker);
        footerPageTitle.textContent = place.place_name;
        let placeNameLength = place.place_name.length;
        console.log(placeNameLength);
        footerPage.style.position = "absolute"
        footerPage.style.top = "2px";
        
        // if(placeNameLength > 12){
        //   footerPage.style.top = "27%";
        // } else if(placeNameLength <= 12) {
        //   footerPage.style.top = "30%";
        // }
        
    });

    // 하단에서 위로 올라오는 페이지 삭제 함수
    function handleDocumentClick(event) {
      if (!footerPage.contains(event.target)) {
        // footerPage.classList.remove("open"); // 클래스 삭제
        footerPage.style.position = "fixed"
        footerPage.style.top = "100%"
        infowindow.close(map, marker);
      }
    }

    // x 버튼 누를시 페이지 내려감
    xBtn.addEventListener("click", function() {
      footerPage.style.top = "100%"
      setTimeout(() => {
        footerPage.style.position = "fixed"

      }, 600);
    })

    document.addEventListener("click", handleDocumentClick);
}
</script>

  
</script>

<!-- 내 위치 찍기 API QUERY -->
<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>

</html>